#!/bin/sh

echo "ğŸ” Running post-pull hook..."

# Check for package.json changes after pull
changed_files="$(git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD 2>/dev/null)"

if echo "$changed_files" | grep -q "package.json"; then
  echo "ğŸ“¦ Dependencies changed. Running pnpm install..."
  pnpm install
fi

# Run build
echo "ğŸ—ï¸ Running build..."
pnpm run build

if [ $? -ne 0 ]; then
  echo "âš ï¸ Build failed after pull. Please check your code."
fi

echo "âœ… Post-pull actions completed."